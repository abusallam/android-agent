# ğŸ—ï¸ TacticalOps Platform - Complete Architecture Documentation\n\n> **Comprehensive system architecture and implementation guide**\n\n---\n\n## ğŸ¯ **System Overview**\n\n**TacticalOps** is a hybrid tactical operations management platform combining:\n- **ğŸŒ PWA Dashboard** - Next.js 15 + React 19 web application\n- **ğŸ“± Mobile App** - React Native + Expo SDK 53 cross-platform app\n- **ğŸ¥ LiveKit Streaming** - Real-time video/audio communication\n- **ğŸ—ºï¸ Tactical Mapping** - Advanced mapping and collaboration tools\n- **ğŸ¤– AI Integration** - Intelligent analytics and automation\n- **ğŸ”„ Real-time Sync** - WebSocket-based live data synchronization\n\n---\n\n## ğŸ›ï¸ **High-Level Architecture**\n\n```mermaid\ngraph TB\n    subgraph \"Client Layer\"\n        PWA[\"ğŸŒ PWA Dashboard<br/>Next.js 15 + React 19\"]\n        Mobile[\"ğŸ“± Mobile App<br/>React Native + Expo\"]\n        Web[\"ğŸŒ Web Browser<br/>Progressive Web App\"]\n    end\n    \n    subgraph \"API Gateway\"\n        NextAPI[\"âš¡ Next.js API Routes<br/>REST + GraphQL\"]\n        WS[\"ğŸ”Œ WebSocket Server<br/>Real-time Communication\"]\n        LiveKit[\"ğŸ¥ LiveKit Server<br/>Video/Audio Streaming\"]\n    end\n    \n    subgraph \"Core Services\"\n        Auth[\"ğŸ” Authentication<br/>JWT + bcrypt\"]\n        DB[\"ğŸ’¾ Database<br/>PostgreSQL + Prisma\"]\n        Cache[\"âš¡ Redis Cache<br/>Session + Real-time\"]\n        Storage[\"ğŸ“ File Storage<br/>Local + Cloud\"]\n    end\n    \n    subgraph \"External Services\"\n        Maps[\"ğŸ—ºï¸ Mapbox<br/>Interactive Maps\"]\n        AI[\"ğŸ¤– OpenAI<br/>AI Analytics\"]\n        Push[\"ğŸ”” Push Notifications<br/>Web + Mobile\"]\n        UAV[\"ğŸš UAV/Drone APIs<br/>MAVLink Protocol\"]\n    end\n    \n    PWA --> NextAPI\n    Mobile --> NextAPI\n    Web --> NextAPI\n    \n    NextAPI --> Auth\n    NextAPI --> DB\n    NextAPI --> Cache\n    NextAPI --> Storage\n    \n    WS --> Auth\n    WS --> Cache\n    \n    LiveKit --> Auth\n    LiveKit --> DB\n    \n    NextAPI --> Maps\n    NextAPI --> AI\n    NextAPI --> Push\n    NextAPI --> UAV\n```"\n## ğŸ”„ 
**Data Flow Architecture**\n\n```mermaid\nsequenceDiagram\n    participant U as User\n    participant PWA as PWA Dashboard\n    participant API as Next.js API\n    participant WS as WebSocket\n    participant LK as LiveKit\n    participant DB as Database\n    participant Mobile as Mobile App\n    \n    U->>PWA: Login\n    PWA->>API: POST /api/auth/login\n    API->>DB: Verify credentials\n    DB-->>API: User data\n    API-->>PWA: JWT token\n    \n    PWA->>WS: Connect with JWT\n    WS->>WS: Authenticate user\n    WS-->>PWA: Connection established\n    \n    U->>PWA: Start video call\n    PWA->>API: POST /api/livekit/token\n    API-->>PWA: LiveKit token\n    PWA->>LK: Connect to room\n    LK-->>PWA: Video/audio stream\n    \n    PWA->>WS: Broadcast event\n    WS->>Mobile: Real-time notification\n    Mobile->>API: Sync data\n    API->>DB: Update status\n```\n\n---\n\n## ğŸ“± **Mobile App Architecture**\n\n```mermaid\ngraph TB\n    subgraph \"React Native App\"\n        App[\"ğŸ“± App.tsx<br/>Main Application\"]\n        Services[\"ğŸ”§ Services Layer\"]\n        Components[\"ğŸ§© UI Components\"]\n        Navigation[\"ğŸ§­ Navigation\"]\n    end\n    \n    subgraph \"Native Services\"\n        Device[\"ğŸ“± DeviceService<br/>Hardware Info\"]\n        Location[\"ğŸ“ LocationService<br/>GPS Tracking\"]\n        Camera[\"ğŸ“· CameraService<br/>Photo/Video\"]\n        Audio[\"ğŸ¤ AudioService<br/>Recording\"]\n        Sensor[\"ğŸ”¬ SensorService<br/>Accelerometer\"]\n        Storage[\"ğŸ’¾ StorageService<br/>Local Data\"]\n        API[\"ğŸŒ ApiService<br/>HTTP Client\"]\n    end\n    \n    subgraph \"Expo SDK 53\"\n        ExpoLocation[\"ğŸ“ expo-location\"]\n        ExpoCamera[\"ğŸ“· expo-camera\"]\n        ExpoAudio[\"ğŸ¤ expo-av\"]\n        ExpoSensors[\"ğŸ”¬ expo-sensors\"]\n        ExpoNotifications[\"ğŸ”” expo-notifications\"]\n    end\n    \n    App --> Services\n    Services --> Device\n    Services --> Location\n    Services --> Camera\n    Services --> Audio\n    Services --> Sensor\n    Services --> Storage\n    Services --> API\n    \n    Device --> ExpoLocation\n    Location --> ExpoLocation\n    Camera --> ExpoCamera\n    Audio --> ExpoAudio\n    Sensor --> ExpoSensors\n```"\n##
 ğŸ¥ **LiveKit Streaming Architecture**\n\n```mermaid\ngraph TB\n    subgraph \"Frontend Components\"\n        VideoGrid[\"ğŸ“º MultiStreamGrid<br/>Video Layout\"]\n        VideoStream[\"ğŸ¥ VideoStreamComponent<br/>Individual Stream\"]\n        Controls[\"ğŸ›ï¸ Media Controls<br/>Camera/Mic/Screen\"]\n    end\n    \n    subgraph \"LiveKit Provider\"\n        Provider[\"ğŸ”— LiveKitProvider<br/>React Context\"]\n        Hooks[\"ğŸª Custom Hooks<br/>useLiveKit, etc.\"]\n        Manager[\"âš™ï¸ ConnectionManager<br/>Connection Logic\"]\n    end\n    \n    subgraph \"API Layer\"\n        TokenAPI[\"ğŸ« /api/livekit/token<br/>JWT Generation\"]\n        RoomAPI[\"ğŸ  /api/livekit/rooms<br/>Room Management\"]\n        ParticipantAPI[\"ğŸ‘¥ /api/livekit/participants<br/>User Management\"]\n    end\n    \n    subgraph \"LiveKit Server\"\n        SFU[\"ğŸ›ï¸ SFU Server<br/>Media Routing\"]\n        Rooms[\"ğŸ  Room Management\"]\n        Tracks[\"ğŸ“¡ Media Tracks\"]\n    end\n    \n    VideoGrid --> Provider\n    VideoStream --> Provider\n    Controls --> Provider\n    \n    Provider --> Hooks\n    Hooks --> Manager\n    \n    Manager --> TokenAPI\n    Manager --> RoomAPI\n    Manager --> ParticipantAPI\n    \n    TokenAPI --> SFU\n    RoomAPI --> Rooms\n    ParticipantAPI --> Tracks\n```\n\n---\n\n## ğŸ”Œ **WebSocket Real-time Architecture**\n\n```mermaid\ngraph TB\n    subgraph \"Client Side\"\n        WSClient[\"ğŸ”Œ WebSocketClient<br/>Connection Manager\"]\n        Hooks[\"ğŸª useRealTimeData<br/>React Hooks\"]\n        Components[\"ğŸ§© UI Components<br/>Live Updates\"]\n    end\n    \n    subgraph \"Server Side\"\n        WSServer[\"ğŸ”Œ WebSocketServer<br/>Connection Pool\"]\n        Auth[\"ğŸ” JWT Authentication<br/>Token Verification\"]\n        Broadcast[\"ğŸ“¡ Message Broadcasting<br/>Event Distribution\"]\n    end\n    \n    subgraph \"Message Types\"\n        DeviceUpdate[\"ğŸ“± Device Status<br/>Real-time Updates\"]\n        LocationUpdate[\"ğŸ“ GPS Location<br/>Position Changes\"]\n        Emergency[\"ğŸš¨ Emergency Alerts<br/>Priority Messages\"]\n        Chat[\"ğŸ’¬ Team Chat<br/>Communication\"]\n    end\n    \n    Components --> Hooks\n    Hooks --> WSClient\n    WSClient <--> WSServer\n    \n    WSServer --> Auth\n    WSServer --> Broadcast\n    \n    Broadcast --> DeviceUpdate\n    Broadcast --> LocationUpdate\n    Broadcast --> Emergency\n    Broadcast --> Chat\n```"