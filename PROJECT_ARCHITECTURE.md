# 🏗️ TacticalOps Platform - Complete Architecture Documentation\n\n> **Comprehensive system architecture and implementation guide**\n\n---\n\n## 🎯 **System Overview**\n\n**TacticalOps** is a hybrid tactical operations management platform combining:\n- **🌐 PWA Dashboard** - Next.js 15 + React 19 web application\n- **📱 Mobile App** - React Native + Expo SDK 53 cross-platform app\n- **🎥 LiveKit Streaming** - Real-time video/audio communication\n- **🗺️ Tactical Mapping** - Advanced mapping and collaboration tools\n- **🤖 AI Integration** - Intelligent analytics and automation\n- **🔄 Real-time Sync** - WebSocket-based live data synchronization\n\n---\n\n## 🏛️ **High-Level Architecture**\n\n```mermaid\ngraph TB\n    subgraph \"Client Layer\"\n        PWA[\"🌐 PWA Dashboard<br/>Next.js 15 + React 19\"]\n        Mobile[\"📱 Mobile App<br/>React Native + Expo\"]\n        Web[\"🌍 Web Browser<br/>Progressive Web App\"]\n    end\n    \n    subgraph \"API Gateway\"\n        NextAPI[\"⚡ Next.js API Routes<br/>REST + GraphQL\"]\n        WS[\"🔌 WebSocket Server<br/>Real-time Communication\"]\n        LiveKit[\"🎥 LiveKit Server<br/>Video/Audio Streaming\"]\n    end\n    \n    subgraph \"Core Services\"\n        Auth[\"🔐 Authentication<br/>JWT + bcrypt\"]\n        DB[\"💾 Database<br/>PostgreSQL + Prisma\"]\n        Cache[\"⚡ Redis Cache<br/>Session + Real-time\"]\n        Storage[\"📁 File Storage<br/>Local + Cloud\"]\n    end\n    \n    subgraph \"External Services\"\n        Maps[\"🗺️ Mapbox<br/>Interactive Maps\"]\n        AI[\"🤖 OpenAI<br/>AI Analytics\"]\n        Push[\"🔔 Push Notifications<br/>Web + Mobile\"]\n        UAV[\"🚁 UAV/Drone APIs<br/>MAVLink Protocol\"]\n    end\n    \n    PWA --> NextAPI\n    Mobile --> NextAPI\n    Web --> NextAPI\n    \n    NextAPI --> Auth\n    NextAPI --> DB\n    NextAPI --> Cache\n    NextAPI --> Storage\n    \n    WS --> Auth\n    WS --> Cache\n    \n    LiveKit --> Auth\n    LiveKit --> DB\n    \n    NextAPI --> Maps\n    NextAPI --> AI\n    NextAPI --> Push\n    NextAPI --> UAV\n```"\n## 🔄 
**Data Flow Architecture**\n\n```mermaid\nsequenceDiagram\n    participant U as User\n    participant PWA as PWA Dashboard\n    participant API as Next.js API\n    participant WS as WebSocket\n    participant LK as LiveKit\n    participant DB as Database\n    participant Mobile as Mobile App\n    \n    U->>PWA: Login\n    PWA->>API: POST /api/auth/login\n    API->>DB: Verify credentials\n    DB-->>API: User data\n    API-->>PWA: JWT token\n    \n    PWA->>WS: Connect with JWT\n    WS->>WS: Authenticate user\n    WS-->>PWA: Connection established\n    \n    U->>PWA: Start video call\n    PWA->>API: POST /api/livekit/token\n    API-->>PWA: LiveKit token\n    PWA->>LK: Connect to room\n    LK-->>PWA: Video/audio stream\n    \n    PWA->>WS: Broadcast event\n    WS->>Mobile: Real-time notification\n    Mobile->>API: Sync data\n    API->>DB: Update status\n```\n\n---\n\n## 📱 **Mobile App Architecture**\n\n```mermaid\ngraph TB\n    subgraph \"React Native App\"\n        App[\"📱 App.tsx<br/>Main Application\"]\n        Services[\"🔧 Services Layer\"]\n        Components[\"🧩 UI Components\"]\n        Navigation[\"🧭 Navigation\"]\n    end\n    \n    subgraph \"Native Services\"\n        Device[\"📱 DeviceService<br/>Hardware Info\"]\n        Location[\"📍 LocationService<br/>GPS Tracking\"]\n        Camera[\"📷 CameraService<br/>Photo/Video\"]\n        Audio[\"🎤 AudioService<br/>Recording\"]\n        Sensor[\"🔬 SensorService<br/>Accelerometer\"]\n        Storage[\"💾 StorageService<br/>Local Data\"]\n        API[\"🌐 ApiService<br/>HTTP Client\"]\n    end\n    \n    subgraph \"Expo SDK 53\"\n        ExpoLocation[\"📍 expo-location\"]\n        ExpoCamera[\"📷 expo-camera\"]\n        ExpoAudio[\"🎤 expo-av\"]\n        ExpoSensors[\"🔬 expo-sensors\"]\n        ExpoNotifications[\"🔔 expo-notifications\"]\n    end\n    \n    App --> Services\n    Services --> Device\n    Services --> Location\n    Services --> Camera\n    Services --> Audio\n    Services --> Sensor\n    Services --> Storage\n    Services --> API\n    \n    Device --> ExpoLocation\n    Location --> ExpoLocation\n    Camera --> ExpoCamera\n    Audio --> ExpoAudio\n    Sensor --> ExpoSensors\n```"\n##
 🎥 **LiveKit Streaming Architecture**\n\n```mermaid\ngraph TB\n    subgraph \"Frontend Components\"\n        VideoGrid[\"📺 MultiStreamGrid<br/>Video Layout\"]\n        VideoStream[\"🎥 VideoStreamComponent<br/>Individual Stream\"]\n        Controls[\"🎛️ Media Controls<br/>Camera/Mic/Screen\"]\n    end\n    \n    subgraph \"LiveKit Provider\"\n        Provider[\"🔗 LiveKitProvider<br/>React Context\"]\n        Hooks[\"🪝 Custom Hooks<br/>useLiveKit, etc.\"]\n        Manager[\"⚙️ ConnectionManager<br/>Connection Logic\"]\n    end\n    \n    subgraph \"API Layer\"\n        TokenAPI[\"🎫 /api/livekit/token<br/>JWT Generation\"]\n        RoomAPI[\"🏠 /api/livekit/rooms<br/>Room Management\"]\n        ParticipantAPI[\"👥 /api/livekit/participants<br/>User Management\"]\n    end\n    \n    subgraph \"LiveKit Server\"\n        SFU[\"🎛️ SFU Server<br/>Media Routing\"]\n        Rooms[\"🏠 Room Management\"]\n        Tracks[\"📡 Media Tracks\"]\n    end\n    \n    VideoGrid --> Provider\n    VideoStream --> Provider\n    Controls --> Provider\n    \n    Provider --> Hooks\n    Hooks --> Manager\n    \n    Manager --> TokenAPI\n    Manager --> RoomAPI\n    Manager --> ParticipantAPI\n    \n    TokenAPI --> SFU\n    RoomAPI --> Rooms\n    ParticipantAPI --> Tracks\n```\n\n---\n\n## 🔌 **WebSocket Real-time Architecture**\n\n```mermaid\ngraph TB\n    subgraph \"Client Side\"\n        WSClient[\"🔌 WebSocketClient<br/>Connection Manager\"]\n        Hooks[\"🪝 useRealTimeData<br/>React Hooks\"]\n        Components[\"🧩 UI Components<br/>Live Updates\"]\n    end\n    \n    subgraph \"Server Side\"\n        WSServer[\"🔌 WebSocketServer<br/>Connection Pool\"]\n        Auth[\"🔐 JWT Authentication<br/>Token Verification\"]\n        Broadcast[\"📡 Message Broadcasting<br/>Event Distribution\"]\n    end\n    \n    subgraph \"Message Types\"\n        DeviceUpdate[\"📱 Device Status<br/>Real-time Updates\"]\n        LocationUpdate[\"📍 GPS Location<br/>Position Changes\"]\n        Emergency[\"🚨 Emergency Alerts<br/>Priority Messages\"]\n        Chat[\"💬 Team Chat<br/>Communication\"]\n    end\n    \n    Components --> Hooks\n    Hooks --> WSClient\n    WSClient <--> WSServer\n    \n    WSServer --> Auth\n    WSServer --> Broadcast\n    \n    Broadcast --> DeviceUpdate\n    Broadcast --> LocationUpdate\n    Broadcast --> Emergency\n    Broadcast --> Chat\n```"